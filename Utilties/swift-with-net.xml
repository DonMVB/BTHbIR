<!--
   This is an updated version of the Swift on Security sysmon filw with event 3 fully enabled. Event 3 controls network connections. 
   By default, the Swift configutation logs suspicius connections. This version traps everything, so it can be useful for malware detection.

  sysmon-config | A Sysmon configuration focused on default high-quality event tracing and easy customization by the community
  Source version:	74 | Date: 2021-07-08
  Source project:	https://github.com/SwiftOnSecurity/sysmon-config
  Source license:	Creative Commons Attribution 4.0 | You may privatize, fork, edit, teach, publish, or deploy for commercial use - with attribution in the text.

  Modified: Enhanced network connection logging (Event ID 3) for full visibility
-->

<Sysmon schemaversion="4.50">
	<!--SYSMON META CONFIG-->
	<HashAlgorithms>md5,sha256,IMPHASH</HashAlgorithms>
	<CheckRevocation/>

	<EventFiltering>

	<!--SYSMON EVENT ID 1 : PROCESS CREATION [ProcessCreate]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessCreate onmatch="exclude">
			<!--SECTION: Microsoft Windows-->
			<CommandLine condition="begin with"> "C:\Windows\system32\wermgr.exe" "-queuereporting_svc" </CommandLine>
			<CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -Embedding</CommandLine>
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -secured -Embedding</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\wermgr.exe -upload</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
			<CommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</CommandLine>
			<CommandLine condition="is">\??\C:\Windows\system32\autochk.exe *</CommandLine>
			<CommandLine condition="is">\SystemRoot\System32\smss.exe</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\RuntimeBroker.exe -Embedding</CommandLine>
			<Image condition="is">C:\Program Files (x86)\Common Files\microsoft shared\ink\TabTip32.exe</Image>
			<Image condition="is">C:\Windows\System32\TokenBrokerCookies.exe</Image>
			<Image condition="is">C:\Windows\System32\plasrv.exe</Image>
			<Image condition="is">C:\Windows\System32\wifitask.exe</Image>
			<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
			<Image condition="is">C:\Windows\system32\PrintIsolationHost.exe</Image>
			<Image condition="is">C:\Windows\system32\SppExtComObj.Exe</Image>
			<Image condition="is">C:\Windows\system32\audiodg.exe</Image>
			<Image condition="is">C:\Windows\system32\conhost.exe</Image>
			<Image condition="is">C:\Windows\system32\mobsync.exe</Image>
			<Image condition="is">C:\Windows\system32\musNotification.exe</Image>
			<Image condition="is">C:\Windows\system32\musNotificationUx.exe</Image>
			<Image condition="is">C:\Windows\system32\powercfg.exe</Image>
			<Image condition="is">C:\Windows\system32\sndVol.exe</Image>
			<Image condition="is">C:\Windows\system32\sppsvc.exe</Image>
			<Image condition="is">C:\Windows\system32\wbem\WmiApSrv.exe</Image>
			<IntegrityLevel condition="is">AppContainer</IntegrityLevel>
			<ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
			<ParentCommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</ParentCommandLine>
			<CommandLine condition="is">C:\WINDOWS\system32\devicecensus.exe UserCxt</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\usocoreworker.exe -Embedding</CommandLine>
			<ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
			<!--SECTION: Windows:svchost-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -p -s camsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k LocalService -p -s BthAvctpSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -p</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k LocalServiceNetworkRestricted -s BTAGService</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s NcbService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -p -s SSDPSRV</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s NgcSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -p -s NgcCtnrSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SCardSvr</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s wuauserv</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k netsvcs -p -s SessionEnv</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k localSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k netsvcs -p -s BDESVC</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s BITS</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wusvcs -p -s WaaSMedicSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
			<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
			<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>
			<CommandLine condition="is">C:\Windows\system32\deviceenroller.exe /c /AutoEnrollMDM</CommandLine>
			<!--SECTION: Microsoft:Edge-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Microsoft\Edge Dev\Application\msedge.exe" --type=</CommandLine>
			<!--SECTION: Microsoft:dotNet-->
			<CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>
			<CommandLine condition="begin with">C:\WINDOWS\Microsoft.NET\Framework64\v4.0.30319\Ngen.exe</CommandLine>
			<CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</CommandLine>
			<CommandLine condition="begin with">C:\WINDOWS\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</CommandLine>
			<Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
			<Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
			<Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
			<ParentCommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
			<!--SECTION: Microsoft:Office-->
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\MSOSYNC.EXE</Image>
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\msoia.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
			<!--SECTION: Microsoft:Office:Click2Run-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
			<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>
			<!--SECTION: Windows: Media player-->
			<Image condition="is">C:\Program Files\Windows Media Player\wmpnscfg.exe</Image>
			<!--SECTION: Google-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
			<CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
		</ProcessCreate>
	</RuleGroup>

	<!--SYSMON EVENT ID 2 : FILE CREATION TIME RETROACTIVELY CHANGED IN THE FILESYSTEM [FileCreateTime]-->
	<RuleGroup name="" groupRelation="or">
		<FileCreateTime onmatch="include">
			<Image name="T1099" condition="begin with">C:\Users</Image>
			<TargetFilename name="T1099" condition="end with">.exe</TargetFilename>
			<Image name="T1099" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
		</FileCreateTime>
	</RuleGroup>

	<RuleGroup name="" groupRelation="or">
		<FileCreateTime onmatch="exclude">
			<Image condition="image">OneDrive.exe</Image>
			<Image condition="image">C:\Windows\system32\backgroundTaskHost.exe</Image>
			<Image condition="contains">setup</Image>
			<Image condition="contains">install</Image>
			<Image condition="contains">Update\</Image>
			<Image condition="end with">redist.exe</Image>
			<Image condition="is">msiexec.exe</Image>
			<Image condition="is">TrustedInstaller.exe</Image>
			<TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
		</FileCreateTime>
	</RuleGroup>

	<!--SYSMON EVENT ID 3 : NETWORK CONNECTION INITIATED [NetworkConnect] - MODIFIED FOR FULL VISIBILITY-->
		<!--COMMENT:	Modified to log ALL network connections with strategic exclusions for noise reduction-->
		<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, User, Protocol, Initiated, SourceIsIpv6, SourceIp, SourceHostname, SourcePort, SourcePortName, DestinationIsIpV6, DestinationIp, DestinationHostname, DestinationPort, DestinationPortName-->
	<RuleGroup name="" groupRelation="or">
		<NetworkConnect onmatch="exclude">
			<!--SECTION: System and Service exclusions to reduce noise while maintaining visibility-->
			<!--Windows System exclusions (high-frequency, low-risk connections)-->
			<Image condition="is">C:\Windows\System32\svchost.exe</Image>
			<Image condition="is">C:\Windows\System32\wuauclt.exe</Image> <!--Windows Update Client-->
			<Image condition="is">C:\Windows\System32\UsoClient.exe</Image> <!--Update Session Orchestrator-->
			<Image condition="is">C:\Windows\System32\SearchIndexer.exe</Image> <!--Windows Search-->
			<Image condition="is">C:\Windows\System32\spoolsv.exe</Image> <!--Print Spooler-->
			<Image condition="is">C:\Windows\System32\WerFault.exe</Image> <!--Windows Error Reporting-->
			<Image condition="is">C:\Windows\System32\backgroundTaskHost.exe</Image>
			
			<!--Microsoft applications with high network activity-->
			<Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image>
			<Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image> <!--Microsoft: Teams-->
			<Image condition="begin with">C:\Program Files\Microsoft Office\</Image> <!--Microsoft Office Suite-->
			<Image condition="begin with">C:\Program Files (x86)\Microsoft Office\</Image> <!--Microsoft Office Suite-->
			
			<!--Microsoft domains (Update delivery and telemetry)-->
			<DestinationHostname condition="end with">.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
			
			<!--OCSP (Certificate validation) known addresses-->
			<DestinationIp condition="is">23.4.43.27</DestinationIp> <!--Digicert-->
			<DestinationIp condition="is">72.21.91.29</DestinationIp> <!--Digicert-->
			
			<!--Loopback and Link-Local addresses-->
			<DestinationIp condition="is">127.0.0.1</DestinationIp>
			<DestinationIp condition="begin with">169.254.</DestinationIp> <!--Link-Local IPv4-->
			<DestinationIp condition="begin with">fe80:</DestinationIp> <!--Link-Local IPv6-->
			<SourceIp condition="is">127.0.0.1</SourceIp>
			<SourceIp condition="begin with">169.254.</SourceIp>
			<SourceIp condition="begin with">fe80:</SourceIp>
			
			<!--Common legitimate ports for system services (remove these lines if you want full visibility)-->
			<DestinationPort condition="is">53</DestinationPort> <!--DNS - Remove this line to see DNS traffic-->
			<DestinationPort condition="is">123</DestinationPort> <!--NTP Time Sync-->
			
			<!--Multicast addresses (typically network discovery)-->
			<DestinationIp condition="begin with">224.</DestinationIp> <!--IPv4 Multicast-->
			<DestinationIp condition="begin with">ff02:</DestinationIp> <!--IPv6 Multicast-->
		</NetworkConnect>
	</RuleGroup>

	<!--SYSMON EVENT ID 5 : PROCESS ENDED [ProcessTerminate]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessTerminate onmatch="include">
			<Image condition="begin with">C:\Users</Image>
			<Image condition="begin with">\</Image>
		</ProcessTerminate>
	</RuleGroup>

	<RuleGroup name="" groupRelation="or">
		<ProcessTerminate onmatch="exclude">
		</ProcessTerminate>
	</RuleGroup>

	<!--SYSMON EVENT ID 6 : DRIVER LOADED INTO KERNEL [DriverLoad]-->
	<RuleGroup name="" groupRelation="or">
		<DriverLoad onmatch="exclude">
			<Signature condition="contains">microsoft</Signature>
			<Signature condition="contains">windows</Signature>
			<Signature condition="begin with">Intel </Signature>
		</DriverLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]-->
	<RuleGroup name="" groupRelation="or">
		<ImageLoad onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</ImageLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 8 : REMOTE THREAD CREATED [CreateRemoteThread]-->
	<RuleGroup name="" groupRelation="or">
		<CreateRemoteThread onmatch="exclude">
			<SourceImage condition="is">C:\Windows\system32\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\svchost.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\wininit.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\csrss.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\services.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\winlogon.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\audiodg.exe</SourceImage>
			<StartModule condition="is">C:\Windows\system32\kernel32.dll</StartModule>
			<TargetImage condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</TargetImage>
		</CreateRemoteThread>
	</RuleGroup>

	<!--SYSMON EVENT ID 9 : RAW DISK ACCESS [RawAccessRead]-->
	<RuleGroup name="" groupRelation="or">
		<RawAccessRead onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</RawAccessRead>
	</RuleGroup>

	<!--SYSMON EVENT ID 10 : INTER-PROCESS ACCESS [ProcessAccess]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessAccess onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</ProcessAccess>
	</RuleGroup>

	<!--SYSMON EVENT ID 11 : FILE CREATED [FileCreate]-->
	<RuleGroup name="" groupRelation="or">
		<FileCreate onmatch="include">
			<TargetFilename name="T1023" condition="contains">\Start Menu</TargetFilename>
			<TargetFilename name="T1165" condition="contains">\Startup\</TargetFilename>
			<TargetFilename name="OutlookAttachment" condition="contains">\Content.Outlook\</TargetFilename>
			<TargetFilename name="Downloads" condition="contains">\Downloads\</TargetFilename>
			<TargetFilename condition="end with">.application</TargetFilename>
			<TargetFilename condition="end with">.appref-ms</TargetFilename>
			<TargetFilename condition="end with">.bat</TargetFilename>
			<TargetFilename condition="end with">.chm</TargetFilename>
			<TargetFilename condition="end with">.cmd</TargetFilename>
			<TargetFilename condition="end with">.cmdline</TargetFilename>
			<TargetFilename name="T1176" condition="end with">.crx</TargetFilename>
			<TargetFilename condition="end with">.dmp</TargetFilename>
			<TargetFilename condition="end with">.docm</TargetFilename>
			<TargetFilename name="DLL" condition="end with">.dll</TargetFilename>
			<TargetFilename name="EXE" condition="end with">.exe</TargetFilename>
			<TargetFilename name="ProcessHostingdotNETCode" condition="end with">.exe.log</TargetFilename>
			<TargetFilename condition="end with">.jar</TargetFilename>
			<TargetFilename condition="end with">.jnlp</TargetFilename>
			<TargetFilename condition="end with">.jse</TargetFilename>
			<TargetFilename condition="end with">.hta</TargetFilename>
			<TargetFilename condition="end with">.job</TargetFilename>
			<TargetFilename condition="end with">.pptm</TargetFilename>
			<TargetFilename condition="end with">.ps1</TargetFilename>
			<TargetFilename condition="end with">.s
